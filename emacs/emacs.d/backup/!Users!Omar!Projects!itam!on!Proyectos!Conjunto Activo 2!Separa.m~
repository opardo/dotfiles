% Separación.m

% ITAM
% Optimización Numérica
% 20 de marzo de 2015
%
% Guillermo Schulz  122375
% Hugo Correa       122951
% Arturo Ávila      124990
% Emilio Morones    124311

% Problema de separación lineal de los conjuntos de datos

load('DATOS SEPARACIÓN')

% Datos del proyecto: z de 100x2 // y de 85x2
%
% [m,col] = size(z);
% [p,col] = size(y);
%
% H = [eye(col) zeros(col,1);zeros(1,col) 0];
% c = zeros(col+1,1);
%
% Se resuelve el problema cuadrático
%
%   min     (1/2)*x'*Q*x+c'*x
%   s.a.    A*x = b
%           F*x >= d
%

plot(z(:,1),z(:,2),'.r',y(:,1),y(:,2),'.b','Linewidth',2)

hold on
[m,col] = size(z); % m=100,col=2
[p,col] = size(y); % p=85,col=2
em = ones(m,1);
ep = ones(p,1);
Q = [eye(col) zeros(col,1);zeros(1,col) 1]; % 1 para hacerla s.p.d.
F = [-z -em; y ep];
d = [ep; em];
A = [];
b = [];
c = zeros(col+1,1);

[iter,X] = ConjActivo(Q,A,F,c,b,d);
Q1 = [eye(col) zeros(col,1);zeros(1,col) 0];

disp('El hiperplano separador es:')
x = X(1:col)
lambda = X(col+1)
disp('La función objetivo en el óptimo es:')
fx = .5*X'*Q1*X + c'*X
disp('El número de iteraciones es:')
iter

% Graficación

tmin = min([z(:,1);y(:,1)]);
tmax = max([z(:,1);y(:,1)]);

t = linspace(tmin,tmax)';
rt = -(X(3)+X(1)*t)/X(2);
rt1 = -(X(3)+1+X(1)*t)/X(2);
rt2 = -(X(3)-1+X(1)*t)/X(2);

plot(t,rt,'--g',t,rt1,'k',t,rt2,'m','Linewidth',2)
title('Problema de separación lineal','Fontsize',12)