%
% Solucion al problema cuadratico con restricciones
% utilizando programacion cuadratica sucesiva.
%
clear all;
close all;
clc;

maxiter = 500;
res_fmincon = zeros(5, 4);
res_propio = zeros(5, 5);

for np = 10:10:50
    x0 = rand(3*np,1);

    % Evaluamos con fmincon
    tic
    % esfera_1, esfera_2
    [~, fval, ~, output, ~, ~] = fmincon('esfera_1', x0, ...
                                         [], [], [], [], [], [], 'esfera_2');
    time = toc;

    res_fmincon(np/10,1) = np;
    res_fmincon(np/10,2) = output.firstorderopt;
    res_fmincon(np/10,3) = fval;
    res_fmincon(np/10,4) = time;

    % Evaluamos con propio
%     tic
%     % esfera_1, esfera_3
%     [x, fval, iter, lambda, fin] = psc_global('esfera_1', 'esfera_2', x0, maxiter);
%     time = toc;
% 
%     res_propio(np/10, 1) = np;
%     res_propio(np/10, 2) = fin;
%     res_propio(np/10, 3) = fval;
%     res_propio(np/10, 4) = time;
%     res_propio(np/10, 5) = iter;
end

% Resultados fmincon
fprintf(1,' no. puntos \t  ||L aum||  \t   f(x)   \t time \n')
fprintf(1,' %2.0f      \t   %2.8f     \t   %3.2f  \t %3.2f  \n', res_fmincon')
fprintf(1,'\n\n')

% Resultados propios
fprintf(1,'| no. puntos  \t ||L aum||   \t   f(x)  \t  time  \t  iter   \n')
fprintf(1,'| %2.0f       \t   %2.8f     \t  %3.2f  \t  %3.2f \t  %2f    \n', res_propio')

% Grafica ultima iteracion
figure
sphere(50);
axis equal
hold on
for j = 1:np
   plot3(x(3*(j - 1) + 1), x(3*(j - 1) + 2), x(3*(j - 1) + 3), 'sk', 'LineWidth', 6);
end


